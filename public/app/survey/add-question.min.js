var questionIndex = 0;
var answerTypeId = "answer-";
var questionId = "question-";
var answerIndex = [];

$(document).ready(function(){
	$("#btn-ganti-judul").click(function(){
		console.log('test');
		getUsers();
	});

	$("#btn-next-question").click(function(){
		answerIndex[questionId+questionIndex] = 0;
		createQuestion();
		questionIndex++;
	});

	function createQuestion(){
	$("#box-body-question").append(
			$('<div/>', {'class':'form-group','id':questionId+questionIndex}).append(
				$('<label/>', {'class':'control-label col-sm-3', 'text':'Question '+(questionIndex+1)})
			).append(
				$('<div/>',{'class':'col-sm-6'}).append(
					$('<input>',{'type':'text','class':'form-control', 'placeholder':'Enter Your Question Here'})
				)
			).append(
				$('<div/>',{'class':'col-sm-3'}).append(
					$('<select/>',{'id':'select-'+questionIndex,'type':'text','class':'form-control', 'placeholder':'Enter Your Question Here'}).append(
						$('<option/>',{'value':'asking', 'text':'Asking'})
					).append(
						$('<option/>',{'value':'slider','text':'Slider'})
					).append(
						$('<option/>',{'value':'star','text':'Star'})
					).append(
						$('<option/>',{'value':'checkboxes','text':'Checkboxes'})
					).append(
						$('<option/>',{'value':'ranking','text':'Ranking'})
					).append(
						$('<option/>',{'value':'image','text':'Image'})
					).append(
						$('<option/>',{'value':'multipe','text':'Multiple Choice'})
					).change({index:questionIndex},function(event){
						var index_ = event.data.index;
						var selectedAnswerType = $("#select-"+index_).val();
						
						createAnswer(index_, selectedAnswerType);

					})
				)
			)
		).append(
			$('<div/>', {'class':'form-group'}).append(
				$('<div/>', {'class':'col-sm-3'})
			).append(
				$('<div/>', {'class':'col-sm-6'}).append(
					$('<i/>',{'class':'fa fa-exchange'})
				).append(
					$('<i/>',{'class':'fa fa-fw'})
				).append(
					$('<label/>',{'text':' Exchange Answer'})
				)
			)
		);
		// $("#p1").append("<h1>test h1</h1>");
	}


	function createAnswer(questionIndex, answerType){
		var answerId = answerTypeId+questionIndex+'-'+answerIndex[questionId+questionIndex];

		$("div[id^='"+answerTypeId+questionIndex+"'").remove();
		
		if (answerType=="asking") {
			createAskingAnswer(questionIndex,answerIndex[questionId+questionIndex], questionId+questionIndex, answerId);
		}else if (answerType=="slider") {
			console.log("slider");
		}else if (answerType=="star") {
			console.log("star");
		}else if (answerType=="checkboxes") {
			createCheckboxesAnswer(questionIndex,answerIndex[questionId+questionIndex], questionId+questionIndex, answerId);
		}else if (answerType=="ranking") {
			console.log("ranking");
		}else if (answerType=="image") {
			console.log("image");
		}else if (answerType=="multipe") {
			console.log("multipe");
		};
	}

	function createAskingAnswer(questionIndex, answerIndex, parentId, answerId){
		$("#"+parentId).after(
			$('<div/>', {'class':'form-group','id':answerId}).append(
				$('<div/>', {'class':'col-sm-3'})
			).append(
				$('<div/>', {'class':'col-sm-6'}).append(
					$('<div/>', {'class':'input-group'}).append(
						$("<span/>",{'class':'input-group-addon'}).append(
							$("<input>", {'type':'radio', 'name':'answer-radio-button-'+questionIndex})
						)
					).append(
						$('<input>',{'type':'text','class':'form-control', 'placeholder':'Enter Your Answer Here'})
					)
				)
			).append(
				$('<div/>', {'class':'col-sm-3'}).append(
					$('<div/>', {'class':'btn-group'}).append(
						$('<button/>',{'class':'btn btn-flat btn-primary', 'type':'button'}).append(
							$('<i/>',{'class':'fa fa-plus'})
						).click({questionIndex:questionIndex, answerId:answerId}, function(event){

							addAnswerAsking(event.data.questionIndex, event.data.answerId);
							
						})
					).append(
						$('<button/>',{'class':'btn btn-flat btn-primary', 'type':'button'}).append(
							$('<i/>',{'class':'fa fa-minus'})
						).click({answerId:answerId},function(event){
							
							var answerId = event.data.answerId;
							$("#"+answerId).remove();
						})
					)
				)
			)
		);

	}

	function addAnswerAsking(questionIndex, answerId){
		var questionIndex_ = questionIndex;
		var answerId_ = answerId;
		var answerIndex_ = answerIndex[questionId+questionIndex_];

		var _answerIndex = answerIndex_+1;
		var _answerId = answerTypeId+questionIndex_+"-"+_answerIndex;

		answerIndex[questionId+questionIndex_] = _answerIndex;

		createAskingAnswer(questionIndex, _answerIndex, answerId, _answerId);
	}


	function createCheckboxesAnswer(questionIndex, answerIndex, parentId, answerId){
		$("#"+parentId).after(
			$('<div/>', {'class':'form-group','id':answerId}).append(
				$('<div/>', {'class':'col-sm-3'})
			).append(
				$('<div/>', {'class':'col-sm-6'}).append(
					$('<div/>', {'class':'input-group'}).append(
						$("<span/>",{'class':'input-group-addon'}).append(
							$("<input>", {'type':'checkbox', 'name':'answer-checkbox-'+questionIndex})
						)
					).append(
						$('<input>',{'type':'text','class':'form-control', 'placeholder':'Enter Your Answer Here'})
					)
				)
			).append(
				$('<div/>', {'class':'col-sm-3'}).append(
					$('<div/>', {'class':'btn-group'}).append(
						$('<button/>',{'class':'btn btn-flat btn-primary', 'type':'button'}).append(
							$('<i/>',{'class':'fa fa-plus'})
						).click({questionIndex:questionIndex, answerId:answerId}, function(event){

							addAnswerCheckboxes(event.data.questionIndex, event.data.answerId);
							
						})
					).append(
						$('<button/>',{'class':'btn btn-flat btn-primary', 'type':'button'}).append(
							$('<i/>',{'class':'fa fa-minus'})
						).click({answerId:answerId},function(event){
							
							var answerId = event.data.answerId;
							$("#"+answerId).remove();
						})
					)
				)
			)
		);

	}

	function addAnswerCheckboxes(questionIndex, answerId){
		var questionIndex_ = questionIndex;
		var answerId_ = answerId;
		var answerIndex_ = answerIndex[questionId+questionIndex_];

		var _answerIndex = answerIndex_+1;
		var _answerId = answerTypeId+questionIndex_+"-"+_answerIndex;

		answerIndex[questionId+questionIndex_] = _answerIndex;

		createCheckboxesAnswer(questionIndex, _answerIndex, answerId, _answerId);
	}

	function getUsers(){
	    $.ajax({
	      type:'GET',
	      url:'/survey/add/question/test',
	      data:{text: "hello world"},
	      success:function(data){
	        $("#title").text(data.msg);
	      }
	    });
	  }
});



